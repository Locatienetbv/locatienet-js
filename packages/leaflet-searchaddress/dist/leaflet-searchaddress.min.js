/*!
 * Locatienet @locatienet/leaflet-searchaddress v1.0.18 (https://github.com/Locatienetbv/locatienet-js/tree/master/packages/leaflet-searchaddress#readme)
 * Copyright 2021-2025 Remco Zut
 * Licensed under MIT (https://github.com/locatienetbv/locatienet-js/LICENSE)
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).L)}(this,function(e){"use strict";function t(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(s){if("default"!==s){var r=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return e[s]}})}}),t.default=e,Object.freeze(t)}var s,r=t(e),n={exports:{}};var o=(s||(s=1,function(e,t){!function(e){class t extends Error{constructor(e,t,s){super(s),this.name="ApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.body=t.body,this.request=e}}function s(e,t,s,r){if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?r:"a"===s?r.call(e):r?r.value:t.get(e)}function r(e,t,s,r,n){if("function"==typeof t||!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,s),s}var n,o,a,i,c,d,l;"function"==typeof SuppressedError&&SuppressedError;class u extends Error{constructor(e){super(e),this.name="CancelError"}get isCancelled(){return!0}}class p{constructor(e){n.set(this,void 0),o.set(this,void 0),a.set(this,void 0),i.set(this,void 0),c.set(this,void 0),d.set(this,void 0),l.set(this,void 0),r(this,n,!1),r(this,o,!1),r(this,a,!1),r(this,i,[]),r(this,c,new Promise((t,c)=>{r(this,d,t,"f"),r(this,l,c,"f");const u=e=>{s(this,n,"f")||s(this,o,"f")||s(this,a,"f")||s(this,i,"f").push(e)};return Object.defineProperty(u,"isResolved",{get:()=>s(this,n,"f")}),Object.defineProperty(u,"isRejected",{get:()=>s(this,o,"f")}),Object.defineProperty(u,"isCancelled",{get:()=>s(this,a,"f")}),e(e=>{s(this,n,"f")||s(this,o,"f")||s(this,a,"f")||(r(this,n,!0,"f"),s(this,d,"f")&&s(this,d,"f").call(this,e))},e=>{s(this,n,"f")||s(this,o,"f")||s(this,a,"f")||(r(this,o,!0,"f"),s(this,l,"f")&&s(this,l,"f").call(this,e))},u)}))}get[(n=new WeakMap,o=new WeakMap,a=new WeakMap,i=new WeakMap,c=new WeakMap,d=new WeakMap,l=new WeakMap,Symbol.toStringTag)](){return"Cancellable Promise"}then(e,t){return s(this,c,"f").then(e,t)}catch(e){return s(this,c,"f").catch(e)}finally(e){return s(this,c,"f").finally(e)}cancel(){if(!(s(this,n,"f")||s(this,o,"f")||s(this,a,"f"))){if(r(this,a,!0),s(this,i,"f").length)try{for(const e of s(this,i,"f"))e()}catch(e){return void console.warn("Cancellation threw an error",e)}s(this,i,"f").length=0,s(this,l,"f")&&s(this,l,"f").call(this,new u("Request aborted"))}}get isCancelled(){return s(this,a,"f")}}const h={BASE:"https://services.locatienet.com",VERSION:"1.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0},y=e=>null!=e,f=e=>"string"==typeof e,m=e=>f(e)&&""!==e,g=e=>"object"==typeof e&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.arrayBuffer&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag]),b=e=>e instanceof FormData,w=e=>{const t=[],s=(e,r)=>{y(r)&&(Array.isArray(r)?r.forEach(t=>{s(e,t)}):"object"==typeof r?Object.entries(r).forEach(([t,r])=>{s(`${e}[${t}]`,r)}):((e,s)=>{t.push(`${encodeURIComponent(e)}=${encodeURIComponent(String(s))}`)})(e,r))};return Object.entries(e).forEach(([e,t])=>{s(e,t)}),t.length>0?`?${t.join("&")}`:""},E=async(e,t)=>"function"==typeof t?t(e):t,v=async(e,t)=>{const[s,r,n,o]=await Promise.all([E(t,e.TOKEN),E(t,e.USERNAME),E(t,e.PASSWORD),E(t,e.HEADERS)]),a=Object.entries({Accept:"application/json",...o,...t.headers}).filter(([e,t])=>y(t)).reduce((e,[t,s])=>({...e,[t]:String(s)}),{});if(m(s)&&(a.Authorization=`Bearer ${s}`),m(r)&&m(n)){const e=(e=>{try{return btoa(e)}catch(t){return Buffer.from(e).toString("base64")}})(`${r}:${n}`);a.Authorization=`Basic ${e}`}return void 0!==t.body&&(t.mediaType?a["Content-Type"]=t.mediaType:g(t.body)?a["Content-Type"]=t.body.type||"application/octet-stream":f(t.body)?a["Content-Type"]="text/plain":b(t.body)||(a["Content-Type"]="application/json")),new Headers(a)},S=(e,s)=>new p(async(r,n,o)=>{try{const n=((e,t)=>{const s=encodeURI,r=t.url.replace("{api-version}",e.VERSION).replace(/{(.*?)}/g,(e,r)=>t.path?.hasOwnProperty(r)?s(String(t.path[r])):e),n=`${e.BASE}${r}`;return t.query?`${n}${w(t.query)}`:n})(e,s),a=(e=>{if(e.formData){const t=new FormData,s=(e,s)=>{f(s)||g(s)?t.append(e,s):t.append(e,JSON.stringify(s))};return Object.entries(e.formData).filter(([e,t])=>y(t)).forEach(([e,t])=>{Array.isArray(t)?t.forEach(t=>s(e,t)):s(e,t)}),t}})(s),i=(e=>{if(void 0!==e.body)return e.mediaType?.includes("/json")?JSON.stringify(e.body):f(e.body)||g(e.body)||b(e.body)?e.body:JSON.stringify(e.body)})(s),c=await v(e,s);if(!o.isCancelled){const e=await(async(e,t,s,r,n,o,a)=>{const i=new AbortController,c={headers:o,body:r??n,method:t.method,signal:i.signal};return a(()=>i.abort()),await fetch(s,c)})(0,s,n,i,a,c,o),d=await(async e=>{if(204!==e.status)try{const t=e.headers.get("Content-Type");if(t)return["application/json","application/problem+json"].some(e=>t.toLowerCase().startsWith(e))?await e.json():await e.text()}catch(e){console.error(e)}})(e),l=((e,t)=>{if(t){const s=e.headers.get(t);if(f(s))return s}})(e,s.responseHeader),u={url:n,ok:e.ok,status:e.status,statusText:e.statusText,body:l??d};((e,s)=>{const r={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...e.errors}[s.status];if(r)throw new t(e,s,r);if(!s.ok){const r=s.status??"unknown",n=s.statusText??"unknown",o=(()=>{try{return JSON.stringify(s.body,null,2)}catch(e){return}})();throw new t(e,s,`Generic Error: status: ${r}; status text: ${n}; body: ${o}`)}})(s,u),r(u.body)}}catch(e){n(e)}});class T{static postRsV1LocateSearchByText(e){return S(h,{method:"POST",url:"/rs/v1/Locate/searchByText",body:e,mediaType:"application/json"})}static postRsV1LocateSearchByAddress(e){return S(h,{method:"POST",url:"/rs/v1/Locate/searchByAddress",body:e,mediaType:"application/json"})}static postRsV1LocateSearchByPosition(e){return S(h,{method:"POST",url:"/rs/v1/Locate/searchByPosition",body:e,mediaType:"application/json"})}static postRsV1RouteCalculateRouteDescription(e){return S(h,{method:"POST",url:"/rs/v1/Route/calculateRouteDescription",body:e,mediaType:"application/json"})}static getRsV1MapRenderMapTile(){return S(h,{method:"GET",url:"/rs/v1/Map/renderMapTile"})}static postRsV1MapRenderMapByBounds(e){return S(h,{method:"POST",url:"/rs/v1/Map/renderMapByBounds",body:e,mediaType:"application/json"})}static postRsV1MapRenderMapByCenter(e){return S(h,{method:"POST",url:"/rs/v1/Map/renderMapByCenter",body:e,mediaType:"application/json"})}static getRsV1CountryList(){return S(h,{method:"GET",url:"/rs/v1/Country/list"})}}class R{static postRsV1LocateSearchByText(e){return S(h,{method:"POST",url:"/rs/v1/Locate/searchByText",body:e,mediaType:"application/json"})}static postRsV1LocateSearchByAddress(e){return S(h,{method:"POST",url:"/rs/v1/Locate/searchByAddress",body:e,mediaType:"application/json"})}static postRsV1RouteCalculateRouteInfo(e){return S(h,{method:"POST",url:"/rs/v1/Route/calculateRouteInfo",body:e,mediaType:"application/json"})}static getRsV1CountryList(){return S(h,{method:"GET",url:"/rs/v1/Country/list"})}}async function C(e,t){const s={locations:e,options:{...t,includePolyline:!0}},r=await R.postRsV1RouteCalculateRouteInfo(s);return{type:"Feature",geometry:{type:"LineString",coordinates:(r.polyline??[]).filter(e=>null!=e.x&&null!=e.y).map(e=>[e.x,e.y])},properties:{distance:r.distance,travelTime:r.travelTime}}}const A=window.LN_API_KEY||function(){const e=document.getElementsByTagName("script"),t=e[e.length-1];return t&&new URLSearchParams(t.src.split("?")[1]).get("apikey")||""}()||"";h.HEADERS={"X-API-KEY":A};const B={apikey:A,locateByText:async function(e,t,s){const r={text:e,country:t,options:s};return(await R.postRsV1LocateSearchByText(r)).filter(e=>null!=e.coordinate?.x&&null!=e.coordinate?.y).map(e=>({type:"Feature",geometry:{type:"Point",coordinates:[e.coordinate?.x||0,e.coordinate?.y||0]},properties:e}))},locateByAddress:async function(e,t){const s={address:e,options:t};return(await R.postRsV1LocateSearchByAddress(s)).filter(e=>null!=e.coordinate?.x&&null!=e.coordinate?.y).map(e=>({type:"Feature",geometry:{type:"Point",coordinates:[e.coordinate?.x||0,e.coordinate?.y||0]},properties:e}))},locateByPosition:async function(e,t){const s={coordinate:Array.isArray(e)?{x:e[0],y:e[1]}:e,options:t};return(await T.postRsV1LocateSearchByPosition(s)).filter(e=>null!=e.coordinate?.x&&null!=e.coordinate?.y).map(e=>({type:"Feature",geometry:{type:"Point",coordinates:[e.coordinate?.x||0,e.coordinate?.y||0]},properties:e}))},calculateRouteInfo:C,calculateRoute:C,countries:async function(){return await R.getRsV1CountryList()}};"undefined"!=typeof window&&(window.LN=window.LN||{},window.LN.Api=B),e.Api=B}(t)}(0,n.exports)),n.exports);class a extends r.Evented{constructor(e,t,s={}){super(),this._map=e,this._container=t,this.options={placeholder:"Zoek adres",language:"nl",...s},this._init()}_init(){r.DomEvent.disableClickPropagation(this._container),r.DomEvent.disableScrollPropagation(this._container);const e=document.createElement("div");e.className="searchaddress-form p-0 w-100",e.innerHTML=`\n\n            <div class="input-group d-flex justify-content-start">\n                <input id="searchaddress-query" type="text" class="form-control rounded-0"\n                       placeholder="${this.options.placeholder}" data-country="${this.options.selectedCountry}" />\n                \n            </div>\n            <div id="searchaddress-result" class="position-absolute list-group mt-1 w-100 pe-3 shadow" style="display:none;"></div>\n            \n        `,this._container.appendChild(e),this._bindEvents(),this.options.query&&(document.getElementById("searchaddress-query").value=this.options.query,this._search())}_renderCountries(){const e=this,t=document.getElementById("searchaddress-countries");if(!t)return;t.innerHTML="";const s=document.createElement("ul");s.className="dropdown-menu dropdown-menu-end",s.style.maxHeight="300px",s.style.overflowY="auto",a.countries.forEach(t=>{const r=document.createElement("li"),n=document.createElement("a");n.className="dropdown-item",n.href="#",n.dataset.country=t.iso2,n.textContent=t.lang[e.options.language||"nl"],r.appendChild(n),s.appendChild(r)}),t.appendChild(s)}_bindEvents(){const e=this._container.querySelector("#searchaddress-query");if(!e)return;e.addEventListener("keyup",t=>{(e.value||"").toString().length>1&&this._search()});const t=this._container.querySelector("#searchaddress-countries");t?.addEventListener("click",e=>{const t=e.target;"A"===t.tagName&&t.dataset.country&&(this.options.selectedCountry=t.dataset.country,this._search())});const s=this._container.querySelector("#searchaddress-result");s?.addEventListener("click",e=>{const t=e.target;t.dataset.address&&this._selectAddress(JSON.parse(t.dataset.address))}),e.addEventListener("focus",()=>{const e=this._container.querySelector("#searchaddress-result");e&&(e.style.display="block")}),e.addEventListener("blur",()=>{setTimeout(()=>{const e=this._container.querySelector("#searchaddress-result");e&&(e.style.display="none")},100)})}_onEnterKeyPressed(){const e=document.getElementById("searchaddress-result");if(!e)return;const t=e.querySelector(".searchaddress-item.active");t&&t.dataset.address&&this._selectAddress(JSON.parse(t.dataset.address))}_search(){this.token&&clearTimeout(this.token);const e=document.getElementById("searchaddress-query"),t=(e?.value||"").toString();this.token=window.setTimeout(()=>{o.Api.locateByText(t,this.options.selectedCountry||"",{minimalResultScore:0,language:this.options.language,numResults:10}).then(e=>this._fill(e))},100)}_fill(e){const t=document.getElementById("searchaddress-result");t&&(t.innerHTML="",e.forEach((e,s)=>{const r=document.createElement("a");r.className="searchaddress-item list-group-item",r.href="#",r.dataset.address=JSON.stringify(e),r.textContent=e.properties.description,t.appendChild(r)}),t.style.display=e.length?"block":"none")}_selectAddress(e){const t=document.getElementById("searchaddress-query");if(!t)return;t.value=e.properties.description||e;const s=document.getElementById("searchaddress-result");s&&(s.style.display="none"),this.fire("address",{address:e})}}a.countries=[];class i extends r.Control{constructor(e){super(e)}onAdd(e){return this._map=e,this._container=r.DomUtil.create("div","leaflet-control-layers"),this._container.style.minWidth="350px",this._searchaddress=new a(this._map,this._container,this.options),this._bindEvents(),this._container}_bindEvents(){this._searchaddress.on("address",e=>{this.fire("address",e)}),this._searchaddress.on("clear",()=>{this._map.fire("clear-address"),this.fire("clear")})}}if(Object.assign(i.prototype,r.Evented.prototype),"undefined"!=typeof window&&window.L){const e=window.L;e.Control=e.Control||{},e.Control.SearchAddress=i,e.control.searchAddress=function(){return new i}}});
//# sourceMappingURL=leaflet-searchaddress.min.js.map
