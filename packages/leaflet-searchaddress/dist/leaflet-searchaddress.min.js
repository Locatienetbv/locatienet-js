/*!
 * Locatienet @locatienet/leaflet-searchaddress v1.0.2 (https://github.com/Locatienetbv/locatienet-js/tree/master/packages/leaflet-searchaddress#readme)
 * Copyright 2021-2025 Remco Zut
 * Licensed under MIT (https://github.com/locatienetbv/locatienet-js/LICENSE)
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).L)}(this,function(e){"use strict";function t(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(s){if("default"!==s){var r=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return e[s]}})}}),t.default=e,Object.freeze(t)}var s,r=t(e),n={exports:{}};var o=(s||(s=1,function(e,t){!function(e){const t=window.LN_API_KEY||function(){const e=document.getElementsByTagName("script"),t=e[e.length-1];return t&&new URLSearchParams(t.src.split("?")[1]).get("apikey")||""}()||"";class s extends Error{constructor(e,t,s){super(s),this.name="ApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.body=t.body,this.request=e}}function r(e,t,s,r){if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?r:"a"===s?r.call(e):r?r.value:t.get(e)}function n(e,t,s,r,n){if("function"==typeof t||!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,s),s}var o,i,a,c,d,l,u;"function"==typeof SuppressedError&&SuppressedError;class h extends Error{constructor(e){super(e),this.name="CancelError"}get isCancelled(){return!0}}class p{constructor(e){o.set(this,void 0),i.set(this,void 0),a.set(this,void 0),c.set(this,void 0),d.set(this,void 0),l.set(this,void 0),u.set(this,void 0),n(this,o,!1),n(this,i,!1),n(this,a,!1),n(this,c,[]),n(this,d,new Promise((t,s)=>{n(this,l,t,"f"),n(this,u,s,"f");const d=e=>{r(this,o,"f")||r(this,i,"f")||r(this,a,"f")||r(this,c,"f").push(e)};return Object.defineProperty(d,"isResolved",{get:()=>r(this,o,"f")}),Object.defineProperty(d,"isRejected",{get:()=>r(this,i,"f")}),Object.defineProperty(d,"isCancelled",{get:()=>r(this,a,"f")}),e(e=>{r(this,o,"f")||r(this,i,"f")||r(this,a,"f")||(n(this,o,!0,"f"),r(this,l,"f")&&r(this,l,"f").call(this,e))},e=>{r(this,o,"f")||r(this,i,"f")||r(this,a,"f")||(n(this,i,!0,"f"),r(this,u,"f")&&r(this,u,"f").call(this,e))},d)}))}get[(o=new WeakMap,i=new WeakMap,a=new WeakMap,c=new WeakMap,d=new WeakMap,l=new WeakMap,u=new WeakMap,Symbol.toStringTag)](){return"Cancellable Promise"}then(e,t){return r(this,d,"f").then(e,t)}catch(e){return r(this,d,"f").catch(e)}finally(e){return r(this,d,"f").finally(e)}cancel(){if(!(r(this,o,"f")||r(this,i,"f")||r(this,a,"f"))){if(n(this,a,!0),r(this,c,"f").length)try{for(const e of r(this,c,"f"))e()}catch(e){return void console.warn("Cancellation threw an error",e)}r(this,c,"f").length=0,r(this,u,"f")&&r(this,u,"f").call(this,new h("Request aborted"))}}get isCancelled(){return r(this,a,"f")}}const y={BASE:"https://services.locatienet.com",VERSION:"1.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0},f=e=>null!=e,m=e=>"string"==typeof e,g=e=>m(e)&&""!==e,E=e=>"object"==typeof e&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.arrayBuffer&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag]),b=e=>e instanceof FormData,w=e=>{const t=[],s=(e,r)=>{f(r)&&(Array.isArray(r)?r.forEach(t=>{s(e,t)}):"object"==typeof r?Object.entries(r).forEach(([t,r])=>{s(`${e}[${t}]`,r)}):((e,s)=>{t.push(`${encodeURIComponent(e)}=${encodeURIComponent(String(s))}`)})(e,r))};return Object.entries(e).forEach(([e,t])=>{s(e,t)}),t.length>0?`?${t.join("&")}`:""},v=async(e,t)=>"function"==typeof t?t(e):t,S=async(e,t)=>{const[s,r,n,o]=await Promise.all([v(t,e.TOKEN),v(t,e.USERNAME),v(t,e.PASSWORD),v(t,e.HEADERS)]),i=Object.entries({Accept:"application/json",...o,...t.headers}).filter(([e,t])=>f(t)).reduce((e,[t,s])=>({...e,[t]:String(s)}),{});if(g(s)&&(i.Authorization=`Bearer ${s}`),g(r)&&g(n)){const e=(e=>{try{return btoa(e)}catch(t){return Buffer.from(e).toString("base64")}})(`${r}:${n}`);i.Authorization=`Basic ${e}`}return void 0!==t.body&&(t.mediaType?i["Content-Type"]=t.mediaType:E(t.body)?i["Content-Type"]=t.body.type||"application/octet-stream":m(t.body)?i["Content-Type"]="text/plain":b(t.body)||(i["Content-Type"]="application/json")),new Headers(i)},T=(e,t)=>new p(async(r,n,o)=>{try{const n=((e,t)=>{const s=encodeURI,r=t.url.replace("{api-version}",e.VERSION).replace(/{(.*?)}/g,(e,r)=>t.path?.hasOwnProperty(r)?s(String(t.path[r])):e),n=`${e.BASE}${r}`;return t.query?`${n}${w(t.query)}`:n})(e,t),i=(e=>{if(e.formData){const t=new FormData,s=(e,s)=>{m(s)||E(s)?t.append(e,s):t.append(e,JSON.stringify(s))};return Object.entries(e.formData).filter(([e,t])=>f(t)).forEach(([e,t])=>{Array.isArray(t)?t.forEach(t=>s(e,t)):s(e,t)}),t}})(t),a=(e=>{if(void 0!==e.body)return e.mediaType?.includes("/json")?JSON.stringify(e.body):m(e.body)||E(e.body)||b(e.body)?e.body:JSON.stringify(e.body)})(t),c=await S(e,t);if(!o.isCancelled){const e=await(async(e,t,s,r,n,o,i)=>{const a=new AbortController,c={headers:o,body:r??n,method:t.method,signal:a.signal};return i(()=>a.abort()),await fetch(s,c)})(0,t,n,a,i,c,o),d=await(async e=>{if(204!==e.status)try{const t=e.headers.get("Content-Type");if(t)return["application/json","application/problem+json"].some(e=>t.toLowerCase().startsWith(e))?await e.json():await e.text()}catch(e){console.error(e)}})(e),l=((e,t)=>{if(t){const s=e.headers.get(t);if(m(s))return s}})(e,t.responseHeader),u={url:n,ok:e.ok,status:e.status,statusText:e.statusText,body:l??d};((e,t)=>{const r={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...e.errors}[t.status];if(r)throw new s(e,t,r);if(!t.ok){const r=t.status??"unknown",n=t.statusText??"unknown",o=(()=>{try{return JSON.stringify(t.body,null,2)}catch(e){return}})();throw new s(e,t,`Generic Error: status: ${r}; status text: ${n}; body: ${o}`)}})(t,u),r(u.body)}}catch(e){n(e)}});class _{static postRsV1LocateSearchByText(e){return T(y,{method:"POST",url:"/rs/v1/Locate/searchByText",body:e,mediaType:"application/json"})}static postRsV1LocateSearchByAddress(e){return T(y,{method:"POST",url:"/rs/v1/Locate/searchByAddress",body:e,mediaType:"application/json"})}static postRsV1RouteCalculateRouteInfo(e){return T(y,{method:"POST",url:"/rs/v1/Route/calculateRouteInfo",body:e,mediaType:"application/json"})}static getRsV1CountryList(){return T(y,{method:"GET",url:"/rs/v1/Country/list"})}}y.BASE="https://services.locatienet.com",y.HEADERS={"X-API-KEY":t};const C={apikey:t,countries:async()=>await _.getRsV1CountryList(),locateByText:async(e,t,s)=>{const r={text:e,country:t,options:s};return await _.postRsV1LocateSearchByText(r).then(e=>e.map(e=>({type:"Feature",geometry:{type:"Point",coordinates:[e.coordinate?.x,e.coordinate?.y]},properties:{description:e.description}})))}};"undefined"!=typeof window&&(window.LN=window.LN||{},window.LN.api=C),e.Api=C}(t)}(0,n.exports)),n.exports);class i extends r.Evented{constructor(e,t,s={}){super(),this._map=e,this._container=t,this.options={placeholder:"Zoek adres",language:"nl",...s},this._init()}_init(){r.DomEvent.disableClickPropagation(this._container),r.DomEvent.disableScrollPropagation(this._container);const e=document.createElement("div");e.className="searchaddress-form p-0 w-100",e.innerHTML=`\n\n            <div class="input-group d-flex justify-content-start">\n                <input id="searchaddress-query" type="text" class="form-control rounded-0"\n                       placeholder="${this.options.placeholder}" data-country="${this.options.selectedCountry}" />\n                \n            </div>\n            <div id="searchaddress-result" class="position-absolute list-group mt-1 w-100 pe-3 shadow" style="display:none;"></div>\n            \n        `,this._container.appendChild(e),this._bindEvents(),this.options.query&&(document.getElementById("searchaddress-query").value=this.options.query,this._search())}_renderCountries(){const e=this,t=document.getElementById("searchaddress-countries");if(!t)return;t.innerHTML="";const s=document.createElement("ul");s.className="dropdown-menu dropdown-menu-end",s.style.maxHeight="300px",s.style.overflowY="auto",i.countries.forEach(t=>{const r=document.createElement("li"),n=document.createElement("a");n.className="dropdown-item",n.href="#",n.dataset.country=t.iso2,n.textContent=t.lang[e.options.language||"nl"],r.appendChild(n),s.appendChild(r)}),t.appendChild(s)}_bindEvents(){const e=this._container.querySelector("#searchaddress-query");if(!e)return;e.addEventListener("keyup",t=>{(e.value||"").toString().length>1&&this._search()});const t=this._container.querySelector("#searchaddress-countries");t?.addEventListener("click",e=>{const t=e.target;"A"===t.tagName&&t.dataset.country&&(this.options.selectedCountry=t.dataset.country,this._search())});const s=this._container.querySelector("#searchaddress-result");s?.addEventListener("click",e=>{const t=e.target;t.dataset.address&&this._selectAddress(JSON.parse(t.dataset.address))}),e.addEventListener("focus",()=>{const e=this._container.querySelector("#searchaddress-result");e&&(e.style.display="block")}),e.addEventListener("blur",()=>{setTimeout(()=>{const e=this._container.querySelector("#searchaddress-result");e&&(e.style.display="none")},100)})}_onEnterKeyPressed(){const e=document.getElementById("searchaddress-result");if(!e)return;const t=e.querySelector(".searchaddress-item.active");t&&t.dataset.address&&this._selectAddress(JSON.parse(t.dataset.address))}_search(){this.token&&clearTimeout(this.token);const e=document.getElementById("searchaddress-query"),t=(e?.value||"").toString();this.token=window.setTimeout(()=>{o.Api.locateByText(t,this.options.selectedCountry||"",{minimalResultScore:0,language:this.options.language,numResults:10}).then(e=>this._fill(e))},100)}_fill(e){const t=document.getElementById("searchaddress-result");t&&(t.innerHTML="",e.forEach((e,s)=>{const r=document.createElement("a");r.className="searchaddress-item list-group-item",r.href="#",r.dataset.address=JSON.stringify(e),r.textContent=e.properties.description,t.appendChild(r)}),t.style.display=e.length?"block":"none")}_selectAddress(e){const t=document.getElementById("searchaddress-query");if(!t)return;t.value=e.properties.description||e;const s=document.getElementById("searchaddress-result");s&&(s.style.display="none"),this.fire("address",{address:e})}}i.countries=[];class a extends r.Control{constructor(e){super(e)}onAdd(e){return this._map=e,this._container=r.DomUtil.create("div","leaflet-control-layers"),this._container.style.minWidth="350px",this._searchaddress=new i(this._map,this._container,this.options),this._bindEvents(),this._container}_bindEvents(){this._searchaddress.on("address",e=>{this.fire("address",e)}),this._searchaddress.on("clear",()=>{this._map.fire("clear-address"),this.fire("clear")})}}if(Object.assign(a.prototype,r.Evented.prototype),"undefined"!=typeof window&&window.L){const e=window.L;e.SearchAddress=e.SearchAddress||{},e.SearchAddress.Control=a}});
//# sourceMappingURL=leaflet-searchaddress.min.js.map
